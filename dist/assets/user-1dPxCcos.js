import{X as f,r as u,D as p,p as m,ac as y,C as _,ad as w,ae as k,af as h,ab as d,ag as C,ah as q,ai as x,aj as I}from"./index-PocizONO.js";const b=f("user",()=>{const c=u("code"),o=p([]),r=u(""),t=p([]),i=m();return{onClickChangeLoginType:s=>{c.value=s},loginType:c,api_sms:async(s,a)=>{try{await y({phone:s,type:1})}catch{_.error("获取验证码失败"),a()}},api_login:async s=>{const a=await w(s);k("userinfo",a,null),h("usermenu"),h("userdata"),_.success("登录成功",1,()=>{a.name?d.push("/home"):d.push("/welcome")})},api_findPassword:async s=>{const a=await C(s);console.log("api_findPassword",a)},api_out:async()=>{await x(),window.localStorage.clear()},api_setUserInfo:async(s,a)=>{await q(s,a)},api_checkin:async()=>{const s=i.userInfo.account_id,{charts:a,current:n,daka:l,info:g}=await I(s);o.length=0,o.push(...a),r.value=n,t.length=0,t.push(...l.map(e=>({...e,class:e.lock?"lock":e.count_process>=e.count_target?"success":e.date===n?"today":"fail"}))),i.userTargets.forEach(e=>{e.val=g[e.id]})},homeCharts:o,homeDate:r,homeDaka:t}});export{b as u};
